<link rel="import" href="../polymer/polymer.html">


<dom-module id="iris-reception">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <iris-connection on-connection-restore="synchronizeData"></iris-connection>
    <iris-workstation id="reception"></iris-workstation>
    <iris-shared-entities namespace="services" value="{{services}}" key="ALL"></iris-shared-entities>

  </template>
  <script>
    Polymer({
      is: 'iris-reception',
      properties: {

      },
      synchronizeData() {
        let init_template = {};
        console.log('Sync data here');
        setTimeout(() => {
          this.$.reception.getServiceInfo().then(d => {
            console.log(d);
            console.log(this.services);

            let map = [];
            _.forEach(this.services, (service, key) => {
              if (d[key + '--enum-service']) {
                d[key + '--enum-service'].id = key;
                map.push(d[key + '--enum-service']);
              } else {
                map.push({
                  id: key
                })
              }
            });
            console.log(map);
          })

        }, 2000);
      }
    });
  </script>
</dom-module>
